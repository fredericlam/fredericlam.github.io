import{h as f,o as c,b as d,d as e,w as u,v as _,F as g,j as p,u as y,t as m,k as n}from"./vendor.aa8207de.js";import{_ as v,a as h}from"./plugin-vue_export-helper.09b10cc5.js";const x={name:"Cervix",components:{},setup(){return f(()=>{}),y(),{}},data(){return{width:0,height:600,margin:{top:10,right:40,bottom:80,left:40},x_scale:[],x_axis:[],y_scale:[],y_axis:[],color_scale:{},colors:["#571845","#C70039","#FFC300"],scales:{lin:"scaleLinear",log:"scaleLog"},count:{total:"total",perCap:"perCapita"},legend:{total:"Total Deaths",perCap:"Per Capita Deaths"},dataset:[],chartState:{},filters:{},sort_by:"Higher",sort_dir:"asc"}},created(){},mounted(){this.width=$("#graphic").width(),this.tooltip=d3.select("#graphic").append("div").attr("class","tooltip_viz"),this.svg=d3.select("#graphic").append("svg").attr("id","graphic").attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this.svg.append("g").attr("class","y axis").attr("transform",`translate(${this.margin.left},0)`).attr("text-anchor","end"),this.g_circles=this.svg.append("g").attr("class","group_circles"),this.svg.append("g").attr("class","x axis").attr("transform",`translate(0,${this.height-this.margin.bottom})`),this.xLine=this.svg.append("line").attr("stroke","rgb(96,125,139)").attr("stroke-dasharray","1,2"),this.chartState.measure=this.count.total,this.chartState.scale=this.scales.lin,this.chartState.legend=this.legend.total;let t=h.get("../data/dataset.json");h.all([t]).then(h.spread(r=>{this.dataset=r.data.map(s=>({id:`dot-${s.country_iso2}-${s.edu_3cat}`,iso:s.country_iso2,country:s.country,year:parseFloat(s.midyear),edu:s.edu_3cat,asr:s.asmr=="NA"?"NA":parseFloat(s.asmr.replace(",","."))})),this.filters.years=Array.from(d3.group(this.dataset,s=>s.year)).map(s=>({year:s[0]})),this.filters.populations_ordered=Array.from(d3.group(this.dataset,s=>s.iso)).map(s=>({iso:s[0],label:s[1][0].country})).sort((s,a)=>{if(s.iso<a.iso)return-1;if(s.iso>a.iso)return 1}),this.filters.educations=Array.from(d3.group(this.dataset,s=>s.edu)).map(s=>({edu:s[0]})),this.color_scale=d3.scaleOrdinal().range(this.colors).domain(this.filters.educations),this.filters.colors=[],this.colors.forEach((s,a)=>{this.filters.colors.push({color:s,edu:this.filters.educations[a].edu})}),this.filters.colors.reverse(),console.table(this.filters.colors),this.redraw()})).catch(r=>{console.error("Error catched",r),this.error=!0}).finally(()=>{})},unmounted(){},methods:{setLegend:function(t){this.svg.select("g.legend").remove(),this.g_legend=this.svg.append("g").attr("class","legend").attr("transform",`translate(40,${this.height-this.margin.bottom/2})`),this.legends=this.g_legend.selectAll(".color").data(t,s=>s.color),this.legends_subgroups=this.legends.enter().append("g").attr("class","group");let r=110;this.legends_subgroups.append("circle").attr("r",6).attr("cx",(s,a)=>(a==1?90:r)*a).attr("cy",10).attr("fill",s=>s.color).style("stroke","#000").style("stroke-width","0.5px"),this.legends_subgroups.append("text").attr("x",(s,a)=>(a==1?90:r)*a+20).attr("y",15).attr("text-anchor","start").text(s=>s.edu)},mouseOver:function(t){this.g_circles.selectAll(".country").transition().duration(50).style("opacity",r=>{if(r.asr=="NA")return 0;let s=.1;return t.includes(r.edu)&&(s=1),s})},mouseOut:function(){this.g_circles.selectAll(".country").style("opacity",t=>t.asr=="NA"?0:1)},redraw:function(){console.info("Sorting","sort_by",this.sort_by,"sort_dir",this.sort_dir),this.setLegend(this.filters.colors),this.dataset.map(t=>(t.sort=t.edu==this.sort_by?t.asr:0,t)),this.dataset_sorted=this.dataset.sort((t,r)=>this.sort_dir=="desc"?r.sort-t.sort:t.sort-r.sort),this.sort_dir=="asc"&&(this.dataset_sorted=this.dataset_sorted.filter(t=>t.sort!=0)),this.filters.populations=Array.from(d3.group(this.dataset_sorted,t=>t.iso)).map(t=>({iso:t[0],label:t[1][0].country})),this.x_scale=d3.scaleBand().domain(this.filters.populations.map(t=>t.iso)).rangeRound([this.margin.left,this.width-this.margin.right]),this.chartState.scale===this.scales.lin&&(this.y_scale=d3.scaleLinear().range([this.height-this.margin.bottom,this.margin.top])),this.chartState.scale===this.scales.log,this.domains=d3.extent(this.dataset,t=>+t.asr),this.y_scale.domain([0,this.domains[1]]).nice(),this.chartState.measure===this.count.perCap?this.y_axis=d3.axisLeft(this.y_scale).ticks(10,".1f").tickSizeOuter(0):(this.y_axis=d3.axisLeft(this.y_scale).ticks(10).tickSize(-(this.width-this.margin.left-this.margin.right)).tickSizeOuter(1),this.x_axis=d3.axisBottom(this.x_scale).ticks(10)),d3.transition(this.svg).select(".y.axis").transition().duration(750).call(this.y_axis),d3.transition(this.svg).select(".x.axis").transition().duration(750).call(this.x_axis),this.circles=this.g_circles.selectAll(".country").data(this.dataset,t=>t.id),this.circles.exit().transition().duration(250).remove(),this.circles.enter().append("circle").attr("class","country").attr("cx",t=>this.x_scale(t.iso)+this.x_scale.bandwidth()/2).attr("cy",this.height-this.margin.bottom).attr("r",6).attr("fill","#fff").style("opacity",t=>t.asr=="NA"?0:1).merge(this.circles).transition().duration(1250).attr("cx",t=>this.x_scale(t.iso)+this.x_scale.bandwidth()/2).attr("cy",t=>this.y_scale(t.asr)).style("opacity",t=>t.asr=="NA"?0:1).attr("attr-edu",t=>t.edu).attr("fill",t=>this.color_scale(t.edu)).style("stroke","#000").style("stroke-width","0.5px")}}},b={class:"container"},w=e("h1",null,"Social inequalities",-1),k=e("h2",{style:{"text-align":"center"}},"Cervical cancer, Age-Standardized Rate, Females, by Level of Education",-1),S={class:"model",id:"model1"},A={class:"row"},C={class:"col-md-2"},L={class:"filters"},O={class:"mb-3"},F=e("label",{class:"form-label"},"Sort by level of education",-1),N=["value"],B={class:"mb-3"},M=e("label",{class:"form-label"},"Sort direction",-1),z=e("option",{value:"asc"},"Ascending",-1),D=e("option",{value:"desc"},"Descending",-1),E=[z,D],V={class:"list-group",id:"countries_list"},j={class:"list-group-item"},H={href:"javascript:void(0)",class:"country_button"},R=["src"],T={class:"col-md-10"},U={class:"story"},q={class:"row"},I={class:"col-md-6"},P={class:"step1"},W=n(" For "),G=e("span",{class:"step_marker",style:{"background-color":"#ffc300"}},"high-education countries",-1),J=n(", cancer rates is low almost everywhere "),K=[W,G,J],Q={class:"col-md-6"},X={class:"step2"},Y=n(" Whereas for "),Z=e("span",{class:"step_marker step_marker_white",style:{"background-color":"#571845"}},"low-education",-1),tt=n(" and "),st=e("span",{class:"step_marker step_marker_white",style:{"background-color":"#c70039"}},"intermediate-education",-1),et=n(" countries, cancer rates are much more variable and disparate. "),rt=[Y,Z,tt,st,et],it=e("div",{id:"graphic"},null,-1);function at(t,r,s,a,l,o){return c(),d("div",b,[w,k,e("div",S,[e("div",A,[e("div",C,[e("div",L,[e("form",null,[e("div",O,[F,u(e("select",{id:"sort_by","onUpdate:modelValue":r[0]||(r[0]=i=>l.sort_by=i),placeholder:"Sort by",class:"form-select",onChange:r[1]||(r[1]=(...i)=>o.redraw&&o.redraw(...i))},[(c(!0),d(g,null,p(l.filters.educations,i=>(c(),d("option",{value:i.edu},m(i.edu),9,N))),256))],544),[[_,l.sort_by]])]),e("div",B,[M,u(e("select",{id:"sort_dir","onUpdate:modelValue":r[2]||(r[2]=i=>l.sort_dir=i),placeholder:"Sort direction",class:"form-select",onChange:r[3]||(r[3]=(...i)=>o.redraw&&o.redraw(...i))},E,544),[[_,l.sort_dir]])])]),e("ul",V,[(c(!0),d(g,null,p(l.filters.populations_ordered,i=>(c(),d("li",j,[e("a",H,[e("img",{src:"../img/flags/"+i.iso+".svg"},null,8,R),n(" "+m(i.label),1)])]))),256))])])]),e("div",T,[e("div",U,[e("div",q,[e("div",I,[e("p",P,[e("a",{href:"#",class:"link_step",onMouseover:r[4]||(r[4]=i=>o.mouseOver(["Higher"])),onMouseout:r[5]||(r[5]=(...i)=>o.mouseOut&&o.mouseOut(...i))},K,32)])]),e("div",Q,[e("p",X,[e("a",{href:"#",class:"link_step",onMouseover:r[6]||(r[6]=i=>o.mouseOver(["Intermediate","Lower"])),onMouseout:r[7]||(r[7]=(...i)=>o.mouseOut&&o.mouseOut(...i))},rt,32)])])])]),it])])])])}var nt=v(x,[["render",at]]);export{nt as default};
